# MM-StackEns

Code for paper "MM-StackEns: A New Deep Multimodal Stacked Generalization Approach for Protein-Protein Interaction Prediction"


#### Requirements
* TensorFlow 2.3.0 
* Spektral 1.0.7
* scikit-learn 0.22.2.post1
* NumPy 1.18.5

#### Running the code
The hyperparameters are specified in configuration files. Please see the files provided in the "config_files" directory.
Before running the code, make sure to specify in the config file the data directory and the directory where you want your models and results to be saved.

Run the following command to train a model on a data set with given train-test splits (Yeast, Human or Human-2021 data sets):

```
python main_ensemble.py config_files/<conf_file_name> --train --fold_start <fold>
```

where <conf_file_name> should be replaced with: yeast.conf, human.conf or human2021.conf and < fold > is:
* 11 for the Yeast and Human data sets (this is the default value, so the argument can be omitted when training on these data sets)
* 0 for the Random subsets of the Human-2021 data set
* 0_0 for the HeldOut subsets of the Human-2021 data set

These values are used for training a model starting from the first fold in each data set, but it is also possible to resume training from a specific fold by providing that fold as argument.
 
Run the following command to run a K-fold cross-validation procedure on a set of interactions:

```
python k_fold_main_ensemble.py config_files/yeast2017.conf --train
```
The number of folds (K) can be set using the `--num_folds` argument. 


#### Data sets

Links for downloading the protein sequences and interactions:
* [Yeast and Human](http://www.marcottelab.org/differentialGeneralization/): Yeast and Human data sets introduced in [1]
* [Human-2021](https://github.com/bmd2007/benchmark_eval/tree/aa42bb3369e79db4cb63e1963afcc8af6d8f5696/PPI_Datasets/Human2021): data sets introduced in [2]
* [Yeast-2017](https://github.com/bmd2007/benchmark_eval/tree/aa42bb3369e79db4cb63e1963afcc8af6d8f5696/PPI_Datasets/Du_Yeast): data set introduced in [3]
* [Multi-species](https://github.com/muhaochen/seq_ppi/tree/master/multi_species/preprocessed): data sets introduced in [4]
* [H. sapiens, M. musculus, C. elegans, E. coli](https://github.com/QUST-AIBBDRC/LightGBM-PPI/tree/master/Dataset/Independent_test): data sets used as independent test sets in multiple studies

The features are generated using:
* The [Bio Embeddings library](https://github.com/sacdallago/bio_embeddings) for the ELMo representation
* The [code](https://github.com/bmd2007/benchmark_eval) provided by [2] for the PhysChem representation

The data folders should contain the following:
* the interactions:
    * placed inside a sub-folder named "interactions" in the case of the Yeast, Human and Human-2021 data sets
    * in a file named "protein_interactions.tsv" in the case of the Yeast-2017 data set
* the features:
    * PhysChem features need to be saved as dictionaries with entries of the form: <protein_code>:< feature_vector> in .pkl files
    * ELMo features need to be placed in a sub-folder name "elmo" (the code reads directly from the files generated by Bio Embeddings)
 

*For questions about the code, please contact me at:* alexandra.albu@ubbcluj.ro 
 
#### Bibliography and Useful links
[1] Park, Y., & Marcotte, E. M. (2012). Flaws in evaluation schemes for pair-input computational predictions. Nature methods, 9(12), 1134-1136.

[2] Dunham, B., & Ganapathiraju, M. K. (2021). Benchmark Evaluation of Protein–Protein Interaction Prediction Algorithms. Molecules, 27(1), 41.

[3] Du, X., Sun, S., Hu, C., Yao, Y., Yan, Y., & Zhang, Y. (2017). DeepPPI: boosting prediction of protein–protein interactions with deep neural networks. Journal of chemical information and modeling, 57(6), 1499-1510.

[4] Chen, M., Ju, C. J. T., Zhou, G., Chen, X., Zhang, T., Chang, K. W., ... & Wang, W. (2019). Multifaceted protein–protein interaction prediction based on Siamese residual RCNN. Bioinformatics, 35(14), i305-i314.


The idea of specifying all hyper-parameters (including the network architecture) in a config file was inspired by the [Argo deep learning library](https://github.com/rist-ro/argo). 
